/*! GestureRecognition 05-01-2015 */
!function(a){"use strict";var b=function(a){for(var b={E:[-22.5,22.5],NE:[22.5,67.5],N:[67.5,112.5],NW:[112.5,157.5],W:[157.5,181],"W ":[-181,-157.5],WS:[-157.5,-112.5],S:[-112.5,-67.5],ES:[-67.5,-22.5]},c=180*a/Math.PI,d=Object.keys(b),e=0;e<d.length;e++){var f=d[e],g=b[f];if(c>=g[0]&&c<g[1])return f.trim()}},c=function(a){this.config={};for(var b in a)this.config[b]=a[b];c.base(this,"constructor")};a.tracking.inherits(c,a.tracking.Tracker),c.prototype.track=function(b,c,d){this.initialized?this.emit("track",this.hornsService.getFlowData([this.lastFrame,b])):(this.config.width=c,this.config.height=d,this.hornsService=new a.OpticalFlow(this.config),this.initialized=!0),this.lastFrame=b},c.VERSION="0.0.1",a.OpticalFlowTracker=c;var d=function(d){this.config={hmm:{states:["a","b","c","d","e","f","g","h"],symbols:["E","NE","N","NW","W","WS","S","ES"],startProbability:{a:.1,b:.1,c:.1,d:.1,e:.1,f:.1,g:.1,h:.1,i:.1,j:.1}},gestures:{right:[["W","W"],["W","W"],["W","W","W"],["W","W","W"],["W","W","W"],["W","W","W"],["WS","W","W"]]},getVideoElement:function(){var b=a.document.createElement("video");return b.style.position="absolute",b.style.left="-1000000000em",b.style.top="-10000000em",b.style.width="160px",b.style.height="120px",b.autoplay=!0,b.preload=!0,b.muted=!0,b.looped=!0,a.document.body.appendChild(b),b},opticalFlow:{},detect:!0,onMove:[],minimalMovementVectorLength:.05};for(var e in d)this.config[e]=d[e];var f=new a.MultiGestureHMM(this.config.hmm),g=new c(this.config.opticalFlow),h=!1,i=[],j=[],k=function(a){this.config.onMove.forEach(function(b){b(a)})}.bind(this);this.teach=function(a,b){f.teach(a,b)},this.onDetect=function(a,b){f.onDetect(a,b)},this.onMove=function(a){this.config.onMove.push(a)},this.clearGatheredGestures=function(){j=[],i=[]},this.startGestureGathering=function(){h=!0,i=[]},this.stopGestureGathering=function(){h=!1,j.push(i)},this.teachGatheredGestures=function(a){this.teach(a,j),this.clearGatheredGestures()},this.startTracking=function(){a.tracking.track(this.config.getVideoElement(),g,{camera:!0})};for(var l in this.config.gestures)this.teach(l,this.config.gestures[l]);g.on("track",function(a){var c=[a.xAvg,a.yAvg],d=Math.sqrt(c[0]*c[0]+c[1]*c[1]);if(d>this.config.minimalMovementVectorLength){var e=Math.atan2(c[1],c[0]),g=b(e);this.config.detect&&(k(g),f.newSymbol(g)),h&&i.push(g)}}.bind(this))};d.VERSION="0.0.1",a.GestureRecognition=d}(this);